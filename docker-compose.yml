services:
  dashboard:
    build: .
    container_name: orienta-dashboard
    ports:
      - "8587:8587"
    volumes:
      # === DATI (read-only per la dashboard) ===
      - ./data:/app/data:ro                        # CSV, registry (sola lettura)
      - ./analysis_results:/app/analysis_results:ro # Report JSON/MD (sola lettura)
      - ./reports:/app/reports:ro                   # Meta report (sola lettura)

      # === CODICE (hot-reload) ===
      - ./app:/app/app:ro
      - ./src:/app/src:ro
      - ./config:/app/config:ro
      - ./.streamlit:/app/.streamlit:ro

      # === DATI (read-write per funzionalita admin) ===
      - ./ptof_inbox:/app/ptof_inbox               # Upload PTOF
      - ./logs:/app/logs                           # Log dashboard

      # === CONFIGURAZIONE ===
      - ./.env:/app/.env:ro
    environment:
      - PYTHONUNBUFFERED=1
      - STREAMLIT_SERVER_HEADLESS=true
      - STREAMLIT_BROWSER_GATHER_USAGE_STATS=false
    restart: unless-stopped
